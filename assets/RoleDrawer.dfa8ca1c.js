var I=Object.defineProperty;var D=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var F=(e,a,t)=>a in e?I(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,g=(e,a)=>{for(var t in a||(a={}))k.call(a,t)&&F(e,t,a[t]);if(D)for(var t of D(a))C.call(a,t)&&F(e,t,a[t]);return e};var p=(e,a,t)=>new Promise((o,l)=>{var c=s=>{try{r(t.next(s))}catch(u){l(u)}},i=s=>{try{r(t.throw(s))}catch(u){l(u)}},r=s=>s.done?o(s.value):Promise.resolve(s.value).then(c,i);r((t=t.apply(e,a)).next())});import{B as R}from"./BasicForm.715a36c3.js";import{u as y}from"./useForm.c8dadad1.js";import{bf as E,J as T,a as P,v as w,f as V,k as f,V as x,X as h,o as A,j as $,z as b,n as B,Y as L}from"./index.919817c1.js";import{S as N}from"./index.18c8a6a3.js";import{s as M,h as O}from"./system.2301cf89.js";import{g as _}from"./dict.d9ee9a6d.js";import{B as U,a as j}from"./index.40997eb9.js";import{_ as q}from"./index.33a4b23c.js";import{h as z}from"./util.7dfa7b10.js";const oe=[{title:"\u89D2\u8272\u7F16\u53F7",dataIndex:"roleId",width:120},{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"roleName",width:200},{title:"\u6743\u9650\u5B57\u7B26",dataIndex:"roleKey",width:150},{title:"\u663E\u793A\u987A\u5E8F",dataIndex:"roleSort",width:100},{title:"\u72B6\u6001",dataIndex:"status",width:120,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),E(N,{checked:e.status==="0",checkedChildren:"\u5DF2\u542F\u7528",unCheckedChildren:"\u5DF2\u7981\u7528",loading:e.pendingStatus,onChange(a){e.pendingStatus=!0;const t=a?"0":"1",{createMessage:o}=T();M(e.id,t).then(()=>{e.status=t,o.success("\u5DF2\u6210\u529F\u4FEE\u6539\u89D2\u8272\u72B6\u6001")}).catch(()=>{o.error("\u4FEE\u6539\u89D2\u8272\u72B6\u6001\u5931\u8D25")}).finally(()=>{e.pendingStatus=!1})}}))},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",width:180},{title:"\u5907\u6CE8",dataIndex:"remark"}],re=[{field:"roleNme",label:"\u89D2\u8272\u540D\u79F0",component:"Input",colProps:{span:8}},{field:"status",label:"\u72B6\u6001",component:"ApiSelect",componentProps:{api:()=>_("sys_normal_disable"),labelField:"dictLabel",valueField:"dictValue"},colProps:{span:8}}],G=[{field:"roleName",label:"\u89D2\u8272\u540D\u79F0",required:!0,component:"Input"},{field:"roleValue",label:"\u89D2\u8272\u503C",required:!0,component:"Input"},{field:"status",label:"\u72B6\u6001",component:"ApiRadioGroup",defaultValue:"0",componentProps:{api:()=>_("sys_normal_disable"),labelField:"dictLabel",valueField:"dictValue"}},{label:"\u5907\u6CE8",field:"remark",component:"InputTextArea"},{label:" ",field:"menu",slot:"menu",component:"Input"}],J=P({name:"RoleDrawer",components:{BasicDrawer:U,BasicForm:R,BasicTree:q},emits:["success","register"],setup(e,{emit:a}){const t=w(!0),o=w([]),[l,{resetFields:c,setFieldsValue:i,validate:r}]=y({labelWidth:90,baseColProps:{span:24},schemas:G,showActionButtonGroup:!1}),[s,{setDrawerProps:u,closeDrawer:m}]=j(n=>p(this,null,function*(){if(c(),u({confirmLoading:!1}),f(o).length===0){const v=z(yield O());o.value=v}t.value=!!(n!=null&&n.isUpdate),f(t)&&i(g({},n.record))})),d=V(()=>f(t)?"\u7F16\u8F91\u89D2\u8272":"\u65B0\u589E\u89D2\u8272");function S(){return p(this,null,function*(){try{const n=yield r();u({confirmLoading:!0}),m(),a("success")}finally{u({confirmLoading:!1})}})}return{registerDrawer:s,registerForm:l,getTitle:d,handleSubmit:S,treeData:o}}});function K(e,a,t,o,l,c){const i=h("BasicTree"),r=h("BasicForm"),s=h("BasicDrawer");return A(),$(s,L(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:b(()=>[B(r,{onRegister:e.registerForm},{menu:b(({model:u,field:m})=>[B(i,{value:u[m],"onUpdate:value":d=>u[m]=d,treeData:e.treeData,fieldNames:{title:"menuName",key:"menuId"},checkable:"",toolbar:"",title:"\u83DC\u5355\u5206\u914D"},null,8,["value","onUpdate:value","treeData"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var W=x(J,[["render",K]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{W as R,ne as a,oe as c,re as s};
